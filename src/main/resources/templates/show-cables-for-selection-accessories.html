<!doctype html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="../../style.css">
    <!--Подключение Bootstrap 4-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <title>Show all cables from base</title>
</head>
<h2 align="center">Отобразить кабели для подбора аксессуаров</h2>
<div class="return-home">
    <a href="/" class="btn-blue">На главную</a>
</div>
<!--<button type="submit" class="submit-btn">Отправить</button>-->
<table>
    <thead class="thead-dark">
    <tr>
        <td>ID</td>
        <td>Обозначение в проекте</td>
        <td>Длина, м</td>
        <td>Сальник</td>
    </tr>
    </thead>
    <tbody>
        <button class="submit-btn">Отправить</button>
        <tr class="data-row" th:each="cable : ${cables}">
            <td style="text-align: center" th:text="${cable.designation}" th:value="${cable.designation}">
            <td style="text-align: center" class="name" th:text="${cable.name}" th:data-value="${cable.name}">
            <td style="text-align: center" th:text="${cable.length}" th:value="${cable.length}">
            <td>
                <select class="cableGlandType">
                    <option name="value" th:value="PG" th:text="PG"></option>
                    <option th:value="MG" th:text="MG"></option>
                    <option th:value="RGG" th:text="RGG"></option>
                </select>
            </td>
            <!--        <td><a th:href="@{'/database/cable/delete-cable-by-id/' + ${cable.id}}" class="btn btn-danger">Удалить</a></td>-->
        </tr>
    </tbody>
</table>
</form>
</body>
</html>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const btn = document.querySelector('.submit-btn');
        const dataRow = document.querySelectorAll('.data-row');

        let dataArr = [];// JSON объект, отправить на бэк
        //TODO посмотреть POST запрос, аякс запрос тут же в скрипте, обработки

        // btn.preventDefault();
        btn.addEventListener('click', function () {
            dataArr = [];
            dataRow.forEach(row => {
                let name = row.querySelector('.name');
                // console.log(name.dataset.value);
                let cableGlandType = row.querySelector('.cableGlandType');
                dataArr.push({name: name.dataset.value, cableGlandType: cableGlandType.value});
                // console.log(dataArr);
            })

        });
    });
</script>
